<!--
    vi: ft=pandoc.markdown
-->

# 文件系统

进程
: 进程就是一个正在执行的程序

地址空间
: 一个进程可用于寻址内存的一套地址集合

文件
: 文件是进程创建的信息逻辑单元

## 布局

MBR
: Master Boot Record，主引导记录

[MBR: [..., 分区表], 分区: [引导块, 超级块, 空闲空间管理, i-node, 根目录, 文件...]]

## 目录

1. 包含固定大小项的简单目录，目录项中有磁盘地址和属性
1. 目录中的每一项只是对i-节点的引用
1. 目录下文件名
   1. 行方式, 指定文件项长度
   2. 堆方式, 指定文件名地址

## 连接

1. 硬链接: 目录项指向I-节点, I-节点中记录链接数
2. 软链接: 路径

## 磁盘空间管理

### 文件

1. 连续分配: 简单, 性能好, 容易造成磁盘碎片
2. 链表分配: (解决碎片)有效利用每个磁盘块, 顺序读取快, 随机读取非常慢
   1. 内存表: 数组链表, -1 EOF
1. i-节点

### 磁盘块

把文件分成很多个连续的块

::: {.example}
设磁盘每道有128KB，旋转时间是8.33毫秒，平均寻道时间是10毫秒，若块大小是K字节，则数据传输率是多少

T=10+8.33/2+K/217*8.33(ms)
:::

#### 空闲块记录

1. 链表
2. 位图

### 备份

1. 所有的目录和已修改的文件相应的I节点号在位图中被标记
2. 其下没有包含被修改的子目录和文件的目录其I节点标记被删除
3. 扫描位图，转储所有被标记的目录
4. 扫描位图，转储所有被标记的文件
