<!--
    vi: ft=pandoc.markdown
-->

# 系统总线

总线的一次信息传送过程，大致可分为如下五个阶段：请求总线，总线仲裁，寻址(目的地址)，信息传送，状态返回(或错误报告)

## 连接方式

* 单总线
  
  使用一条总线来连接CPU、主存和I/O设备, 结构简单，成本低廉，但运行效率差，总线负荷重。

* 多总线
  
  体现了高速、中速、低速设备连接到不同的总线上同时进行工作，以提高总线的效率和吞吐量，而且处理器结构的变化不影响高速总线。
  
  通过桥CPU总线、系统总线和高速总线彼此相连。桥实质上是一种具有缓冲、转换、控制功能的逻辑电路。

## 结构

### 早期

CPU是唯一的主控者, 虽然后来加了DMA, 但仍然不能满足多CPU的环境

1. 地址总线 

   一般为单向三态，用来传输地址信息，地址线的位数决定了微机系统的寻址范围. 主存和IO设备接口电路的地址

2. 数据总线 

   一般为双向三态，用来传输数据，数据总线的宽度（位数）反映了总线传输数据的速率

3. 控制总线

   用来传输控制或状态信号。它根据使用条件不同，有的为单向，有的为双向传输，有的是三态，有的是非三态。控制总线代表了总线的控制能力　

### 现代

1. 数据传送总线 (地址, 数据, 控制线)
2. 总裁总线
3. 中断和同步总线
4. 共用线

## 传输方式

* 串行传送
* 并行传送
* 分时传送

## 总裁

1. 集中式仲裁
   1. 链式查询方式: 线路简单，易扩充，对故障敏感，不灵活
   2. 计数器定时查询方式: 可程序设置
   3. 独立请求方式: 速度快，灵活可程序设置，线路复杂
1. 分布式总裁

## 定时

* 同步定时: 事件出现在总线上的时刻由总线时钟信号来确定，总线周期的长度是固定的
* 异步定时: 后一事件出现在总线上 的时刻取决于前一事件的出现，建立在应答式或互锁机制基础上，不需要统一的公共时钟信号。在异步定时中，总线周期的长度是可变的

## 实现

### PCI

与处理器无关的**高速外围总线**, 采用**同步时序协议**和**集中式总裁策略**, 具有**自动配置**的能力

猝发式传送. 利用桥实现总线间的猝发式传送, 使所有存取按需出现在总线上. 允许多条总线并行工作.

低成本小系统, 微型机

### InfiniBand标准

瞄准了高端服务器市场的最新**I/O规范**，它是一种基于开关的体系结构，可连接多达**64000**个服务器、存储系统、网络设备，能替代当前服务器中的PCI总线，数据传输率高达**30GB/s**。因此适合于高成本的**较大规模计算机系统**。